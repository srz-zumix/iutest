- .gtest-version-action-template: &gtest-version-action-template
  type: "BUILD"
  working_directory: "/buddy/iutest"
  docker_image_name: "srzzumix/googletest"
  execute_commands:
  - "cd test"
  - "make USE_GTEST=1             ${MAKE_OPTION} gtest-version"
  - "make USE_GTEST=1 USE_GMOCK=1 ${MAKE_OPTION} gtest-version"
  mount_filesystem_path: "/buddy/iutest"
  shell: "SH"
  trigger_condition: "ALWAYS"

- pipeline: "build-arm-none-eabi"
  trigger_mode: "ON_EVERY_PUSH"
  ref_name: "(^(master|develop)*$)"
  ref_type: "WILDCARD"
  # always_from_scratch: true
  auto_clear_cache: true
  actions:
  - action: "Build Docker image"
    type: "DOCKERFILE"
    login: "srzzumix"
    password: "${zumix_dockerhub}"
    docker_image_tag: "latest"
    dockerfile_path: ".ci/docker/arm-none-eabi/Dockerfile"
    repository: "srzzumix/arm-none-eabi-gcc-with-python"
  - action: "Execute: arm-none-eabi-gcc --version"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/arm-none-eabi-gcc-with-python"
    docker_image_tag: "latest"
    execute_commands:
    - "export PATH=$PATH:/usr/local/bin/gcc-arm-none-eabi-7-2017-q4-major/bin"
    - "arm-none-eabi-gcc --version"
    - "cd test"
    - "make CC=arm-none-eabi-gcc CXX=arm-none-eabi-g++ showcxxversion showcxxmacros DEFS=\"--specs=nosys.specs -mthumb -mcpu=cortex-m3\""
    - "make CC=arm-none-eabi-gcc CXX=arm-none-eabi-g++ DEFS=\"--specs=nosys.specs -mthumb -mcpu=cortex-m3\""
    mount_filesystem_path: "/buddy/iutest"
    shell: "BASH"
    trigger_condition: "ALWAYS"
- pipeline: "gtest-version"
  trigger_mode: "SCHEDULED"
  ref_name: "develop"
  ref_type: "BRANCH"
  start_date: "2018-03-19T03:14:00.000Z"
  delay: 10080
  run_always: true
  actions:
  - action: "lastest"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "latest"
    setup_commands:
    - "export MAKE_OPTION=\"GTEST_EXPECT_VER=0x01080100 GTEST_EXPECT_LATEST=1\""
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             ${MAKE_OPTION} gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 ${MAKE_OPTION} gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.8.1"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.8.1"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01080100 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01080100 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.8.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.8.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01080000 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01080000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.7.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.7.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01070000 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01070000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.6.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.6.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01060000 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01060000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.5.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.5.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01050000 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01050000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.4.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.4.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01040000 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01040000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.3.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.3.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01030000 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01030000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "BASH"
    trigger_condition: "ALWAYS"
  - action: "release-1.2.1"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.2.1"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01020100 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01020100 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "BASH"
    trigger_condition: "ALWAYS"
  - action: "release-1.2.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.2.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01020000 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01020000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.1.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.1.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1 GTEST_EXPECT_VER=0x01010000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.0.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.0.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1 GTEST_EXPECT_VER=0x01000000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
- pipeline: "gtest-compatible-released"
  trigger_mode: "ON_EVERY_PUSH"
  ref_name: "master"
  ref_type: "BRANCH"
  actions:
  - action: "release-1.8.1"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.8.1"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01080100 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01080100 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.8.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.8.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01080000 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01080000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.7.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.7.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01070000 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01070000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.6.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.6.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01060000 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01060000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.5.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.5.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01050000 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01050000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.4.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.4.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01040000 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01040000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.3.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.3.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01030000 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01030000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "BASH"
    trigger_condition: "ALWAYS"
  - action: "release-1.2.1"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.2.1"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01020100 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01020100 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "BASH"
    trigger_condition: "ALWAYS"
  - action: "release-1.2.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.2.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01020000 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01020000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.1.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.1.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1 GTEST_EXPECT_VER=0x01010000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.0.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.0.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1 GTEST_EXPECT_VER=0x01000000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
