# google test version detect test
- pipeline: "gtest-version"
  trigger_mode: "ON_EVERY_PUSH"
  ref_name: "develop"
  ref_type: "BRANCH"
  actions:
  - action: "lastest"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "latest"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01080100 GTEST_EXPECT_LATEST=1 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01080100 GTEST_EXPECT_LATEST=1 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.8.1"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.8.1"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01080100 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01080100 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.8.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.8.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01080000 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01080000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.7.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.7.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01070000 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01070000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.6.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.6.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01060000 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01060000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.5.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.5.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01050000 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01050000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.4.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.4.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01040000 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01040000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.3.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.3.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01030000 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01030000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "BASH"
    trigger_condition: "ALWAYS"
  - action: "release-1.2.1"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.2.1"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01020100 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01020100 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "BASH"
    trigger_condition: "ALWAYS"
  - action: "release-1.2.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.2.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01020000 gtest-version"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01020000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.1.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.1.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1 GTEST_EXPECT_VER=0x01010000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.0.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.0.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1 GTEST_EXPECT_VER=0x01000000 gtest-version"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"

# for test branch
- pipeline: "buddy-test-pipeline"
  trigger_mode: "ON_EVERY_PUSH"
  ref_name: "buddy/*"
  ref_type: "BRANCH"
  actions:
  - action: "Run iutest/gtest-compatible-released"
    type: "RUN_NEXT_PIPELINE"
    comment: "Triggered by $BUDDY_PIPELINE_NAME execution #$BUDDY_EXECUTION_ID"
    revision: "INHERIT"
    trigger_condition: "ALWAYS"
    next_pipeline_id: 177449
  - action: "Run iutest/gtest-version"
    type: "RUN_NEXT_PIPELINE"
    comment: "Triggered by $BUDDY_PIPELINE_NAME execution #$BUDDY_EXECUTION_ID"
    revision: "INHERIT"
    trigger_condition: "ALWAYS"
    next_pipeline_id: 177448

# released google test compatible test
- pipeline: "gtest-compatible-released"
  trigger_mode: "ON_EVERY_PUSH"
  ref_name: "master"
  ref_type: "BRANCH"
  actions:
  - action: "release-1.8.1"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.8.1"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01080100 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01080100 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.8.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.8.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01080000 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01080000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.7.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.7.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01070000 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01070000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.6.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.6.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01060000 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01060000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.5.0"
    type: "BUILD"
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.5.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01050000 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01050000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.4.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.4.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01040000 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01040000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.3.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.3.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01030000 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01030000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "BASH"
    trigger_condition: "ALWAYS"
  - action: "release-1.2.1"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.2.1"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01020100 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01020100 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "BASH"
    trigger_condition: "ALWAYS"
  - action: "release-1.2.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.2.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1             GTEST_EXPECT_VER=0x01020000 test"
    - "make USE_GTEST=1 USE_GMOCK=1 GTEST_EXPECT_VER=0x01020000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.1.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.1.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1 GTEST_EXPECT_VER=0x01010000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
  - action: "release-1.0.0"
    type: "BUILD"
    disabled: true
    working_directory: "/buddy/iutest"
    docker_image_name: "srzzumix/googletest"
    docker_image_tag: "release-1.0.0"
    execute_commands:
    - "cd test"
    - "make USE_GTEST=1 GTEST_EXPECT_VER=0x01000000 test"
    mount_filesystem_path: "/buddy/iutest"
    shell: "SH"
    trigger_condition: "ALWAYS"
